function Create-NewADUser {

    [CmdletBinding()]
        
    Param(              
        [PARAMETER(Mandatory=$True,
        ValueFromPipeline=$True,
        ValueFromPipelineByPropertyName=$True)]        
        [psobject[]]$UserObject
    )

    $Parms=@{
    AccountExpirationDate = $UserObject.AccountExpirationDate;
    AccountPassword =  $UserObject.AccountPassword;
    ChangePasswordAtLogon = $True;  
    DisplayName = $UserObject.DisplayName; 
    EmailAddress = $UserObject.EmailAddress;
    EmployeeNumber = $UserObject.ID; 
    GivenName = $UserObject.Firstname; 
    HomeDirectory = $UserObject.HomeDirectory; 
    HomeDrive ="G:"; 
    Name = $UserObject.Username; 
    Path = $UserObject.Path;     
    SamAccountName = $UserObject.Username;  
    Surname = $UserObject.Surname; 
    UserPrincipalName = $UserObject.UserPrincipalName;
    OtherAttributes = @{'EmployeeType'="student"}     
    }

    try {
        new-aduser @Parms -WhatIf -ea Stop 
    } catch {
        write $x
    }

} # End Function
